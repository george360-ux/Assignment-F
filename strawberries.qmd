---
title: "strawberries report"
format: html
editor: visual
---

# Strawberries

```{r}
#| label: load libraries and set options 
#| warning: false
#| message: false
#| echo: false

library(knitr)  
library(kableExtra)
library(tidyverse)
library(stringr)
library(labelled)
library(data.table)

source("Functions.R")

```


## Introduction

Strawberries are one of the most widely cultivated fruit crops in the United States, with production heavily concentrated in states such as California and Florida. To sustain high yields and consistent quality, strawberry growers depend on fertilizers to supply essential plant nutrients. However, fertilizer use also raises important questions about environmental impact, soil health, and sustainbility. This project analyzes data on strawberry fertilizer use across US states. The goal is to explore patterns, trends, and potential pros/cons of different fertilizer type including Nitrogen, Phosphate, Potash and Sulfur to understand how these inputs vary by geography and time.

We begin by cleaning and structuring the data to ensure technical correctness, then conduct exploratory analyses that focus on:

-   Usage distribution by fertilizer type

-   Geographic difference in fertilizer use

-   Trends in fertilizer use over time

-   Relationships among fertilizer types

The approach follows a structured analytically strategy

1.  Clean → 2. Explore → 3. Interpret → 4. Report

The purpose of the exploratory data analysis is to not draw conclusion but to hopefully have a better understanding on how fertilizer use reflects broader management practices in strawberry agriculture. The results can serve as a foundation for future work linking fertilizer management to yield, soil health and environmental sustainability.


## Intro

When you go the market and look in the produce section, you see all sorts of fruits and vegetables, but do you ever stop to think about where they are coming from or the farming process that got them there for you to purchase and consume? Here we will specifically look at the production of strawberries in the United States.

The United States Department of Agriculture (USDA) collects census and survey data regularly on all of the major crops grown in the United States. To analyze the strawberry crop, we will look at data collected by the USDA through census' and surveys from 1997 to 2025. We will focus on the six states that produce the majority of the strawberries consumed: California, Florida, Washington, Oregon, North Carolina and New York.

Main data source: [USDA Quickstats](https://quickstats.nass.usda.gov/)



## Raw Data and Acquisition

The data set was provided by the USDA Strawberry Production Survey. It contains information about fertilizer application types, quantities, and related descriptors by US states and year.

Fertilizer use is a key input determining yield and environmental impact. Comparing fertilizer types (organic vs conventional) provides insight into production sustainability. We are looking at comparison between organic and conventional strawberries. Fertilizers used in the strawberries are used to determine organic and conventional products

| Chemical | Role | Typical Form | Organic Status |
|------------------|------------------|------------------|------------------|
| Nitrogen (N) | Leaf/vegetative growth | Urea, Ammonium Nitrate | Not organic unless it came from compost |
| Phosphate (P) | Root development | Superphosphate | Synthetic |
| Potash (K) | Disease resistance | Potassium chlroride or Sulfate | Natural forms like potassium from mineral sources can be organic |
| Sulfur (S) | Disease control | Elemental sulfur | Allows in orgnanic systems if naturally derived |

To achieve data a technically correct data-set, we implemented a modular cleaning pipeline that

-   Standardized column names

-   Trimmed white spaces and punctuation

-   Removed uninformative columns (state_ansi, constant columns)

-   Passed numeric columns safely

-   Cleaned text fields (data_item, domain_category -\> fertilizer)

-   Removed NA and zero values


## What fertilizers are being used in strawberry farming?

Fertilizer is an important element in the farming process because just like humans, plants need essential nutrients to thrive. Think of fertilizer like a multivitamin for humans. The most important nutrients for plants are carbon, hydrogen, and oxygen. Plants get these from air and water. The others are obtained from soil, but sometimes the soil isn't naturally nutrient dense or has been farmed many times and the plants need supplemental nutrients. The primary macro nutrients plants need are nitrogen, phosphorus, and potassium. The secondary macro nutrients for plants are sulfur, calcium, and magnesium. Plants also have a need for further micro nutrients, but for this research, we will focus on a few of the macro nutrients.

We sourced some data to analyze use of fertilizer on strawberry crops from the same USDA database above. The four nutrient fertilizers that the USDA collected data about are: Nitrogen, Phosphate, Potash and Sulfur. Nitrogen is helpful to support green, leafy growth. Phosphate helps the root, flower and fruit development. Potash (or potassium) helps a plant's stress tolerance and disease resistance. Sulfur helps a overall plant health and enzyme and nutrient metabolism. These are important macro nutrients for healthy plant growth, along with others.

## What constitutes organic produce?

For a crop to be considered organic, there are certain conditions that need to be followed by the farmers. This means farmers cannot use certain typical farming practices used to grow conventional products. Farmers cannot use inorganic fertilizers, genetic engineering, or radiation on their products.

For a product to have the USDA Organic seal, the product must have more than 95% certified organic ingredients. One of the biggest differences is organic produce is exposed to less toxic pesticides and chemicals during the growing process.

Source: https://www.mayoclinic.org/healthy-lifestyle/nutrition-and-healthy-eating/in-depth/organic-food/art-20043880

## Are these fertilizers used on conventional and/or organic strawberries?

Since all four of these nutrients are essential for crop growth, they are used by farmers growing conventional and organic strawberries. However, the source of the fertilizer differs because there are organic and inorganic fertilizers.

Inorganic fertilizers are typically manufactured, water-soluble products and are not carbon based. They generally tend to be cheaper due to their manufacturing process and have easy calculations to determine application rate. Depending on the form of the fertilizer, you can also but liquid fertilizer for quick absorption or slow-release forms of fertilizer for a release of nutrients over time. One of the negatives to inorganic fertilizer is some of the synthetic compounds used can cause environmental harm through leaching or runoff.

Organic fertilizers are typically derived from living organisms and are carbon-based. Some fertilizers might be derived from fish emulsion or blood meal as the base. Since they are derived from these living organisms, organic fertilizers are generally more expensive and considered to be slow-release. This is because the soil needs a couple of days to weeks to transform the organic nutrients into a form the plants can more readily absorb. Because of this, it can be difficult to calculate application rates with precision. One of the negatives of organic fertilizer is that it may contain weeds or pathogens, like Salmonella, since both can be found in the various living organisms that the fertilizer is derived from.

While choice of fertilizer is important, it is still recommended to add other organic materials to help support the soil, specifically carbon-based materials like compost or grass clippings. Items like these or other ground cover can help plants receive the other macro and micro nutrients needs for healthy growth.

Source: https://extension.umn.edu/manage-soil-nutrients/quick-guide-fertilizing-plants#:\~:text=Plants%20lacking%20nitrogen%20will%20show,moisture%2C%20or%20damage%20to%20roots.


## Topic: Explore Fertilizer Use in Strawberry Cultivation.

Exploratory Questions:

1.  Why is fertilizer important?
    -   <https://www.yara.com/knowledge-grows/five-important-facts-about-fertilizers/>

        -   Nitrogen fertilizer was created by Sam Eyde and Kristian Birkeland in December of 1905. This has changed agriculture and contributed to the high crop yields of today. The possibility of feeding the growing population of the world is thanks to fertilizer improvements. The critical plant nutrients are the macronutrients nitrogen, phosphorus, potassium, calcium, sulphur, magnesium, oxygen, hydrogen, carbon, and the micronutrients iron, boron, chlorine, manganese, zinc, copper, molybdenum and nickel. Planting crops depletes the soil, and the fertilizers replenish them to ensure that future crops have a good foundation for growth.

        -   "The most common sources of nutrients in mineral fertilizers are nitrogen, potassium and phosphate."
2.  What are the most used fertilizers by state, based on the data set?
    -   Answer: From the fertilizer_state data we can see that many fertilizers are used equally as often. Nitrogen, Phosphate, and Potash (Potassium) seem to be used an equal amount of times across the different states in the data set. This aligns with the information from the Yara website.



## Data Cleaning Steps

First, we read in the data from our USDA source and remove any columns that only have one data value and thus will not be useful in our data analysis.

```{r}
#| label: read in the data & run drop 1-item columns function on data

# Read in the csv data file
strawb <- read_csv("strawberry_10Oct25.csv", col_names = TRUE)

# Run the function on the strawberry data
strawb <- drop_one_value_col(strawb)
```

<hr>

Upon first look at the data, we have numeric data. In order to be able to work with the data and perform exploratory analysis, we must convert the data into a numeric structure.

```{r}
#| label: Verify the class of columns 
#| warning: false

# Converting the Value and CV(%) columns from character into numeric structure.
strawb <- strawb %>% 
  mutate(Value = as.numeric(gsub(",", "", strawb$Value))) %>% 
  mutate(`CV (%)` = as.numeric(strawb$`CV (%)`))

```

The column `Data Item` gives us a lot of information. In order to make it more useful, we will remove the phrases common to all elements of the data set. Thus, it becomes a more informative column about the numeric data values.

```{r}
#| label: Clean up Data Item column

# Remove strawberries from the start of every line in Data Item
strawb$`Data Item` <- str_replace(strawb$`Data Item`, "^ST.*IES((\ -\ )|(,\ ))", "")

```

<hr>

The data comes from surveys and census'. There are some differences in the data collection that will make it difficult to clean the dataset while it is all together. Here we split the data into separate survey and census data frames for further cleaning.

```{r}
#| label: split survey/census & drop all one again

# Filter for only the SURVEY data
strawb_survey <- strawb %>% 
  filter(Program == "SURVEY")

# Filter for only the CENSUS data
strawb_census <- strawb %>% 
  filter(Program == "CENSUS")

# Run drop one value columns again
strawb_survey <- drop_one_value_col(strawb_survey)
strawb_census <- drop_one_value_col(strawb_census)

```

<hr>

# Census Data for strawberries

Once we've split the data, the census data is ready to pivot so that each row represents the year for a state and each observation for that year is in a column.

```{r}
#| label: pivot strawb_census wider 

strawb_census_wide <- strawb_census %>%
  pivot_wider(
    id_cols = c(Year, State),          # Columns that uniquely identify each new wide row
    names_from = `Data Item`,          # Column whose values will become the new column names
    values_from = c(Value, `CV (%)`)   # Column whose values will fill the new columns
  )
```

<hr>

# Survey Data for strawberries

Now that the census data is complete, let's take a look at the survey data.

The survey data is a bit more complicated because each state has a bit of variability in how they report the information. We will need to split up the survey data by state. Before making that split, some of the values are a forecast for the year, but the year value is also provided. Because of this, if the `Period` column contains the word "forecast" we will remove that line from the data set.

```{r}
#| label: remove "Forecast" rows from the dataset

# Remove rows predicting "FORCAST"
strawb_survey <- strawb_survey %>% 
  filter(!str_detect(Period, "FORECAST")) 

```

Now, let's split the survey data up into the data from each of the six states and look at each state separately. For most of the states, we will remove the `Week Ending` column and the `State ANSI` column as they would be removed by the drop one value column function. I also wrote a function to drop duplicate rows since sometimes everything is the same except the period, which differs as "year" to "marketing year". This function will be run on each state's data set. Below we can clean New York, Washington, and Oregon with little effort.

```{r}
#| label: looking at and cleaning New York survey data

# Filter for NY and remove unneeded columns
new_york <- strawb_survey %>% 
  filter(State == "NEW YORK") %>% 
  select(-`Week Ending`, -`State ANSI`)

# Run function to remove duplicate rows
new_york <- drop_duplicate_rows(new_york)

```

```{r}
#| label: looking at and cleaning Washington survey data

# Filter for WA and remove unneeded columns
washington <- strawb_survey %>% 
  filter(State == "WASHINGTON") %>% 
  select(-`Week Ending`, -`State ANSI`)

# Run function to remove duplicate rows
washington <- drop_duplicate_rows(washington)

```

```{r}
#| label: looking at and cleaning Oregon survey data

# Filter for OR and remove unneeded columns
oregon <- strawb_survey %>% 
  filter(State == "OREGON") %>% 
  select(-`Week Ending`, -`State ANSI`) 

# Run function to remove duplicate rows
oregon <- drop_duplicate_rows(oregon)

```

North Carolina reported their data in weekly increments for the `Period` column, so we needed to address that and average out the year based on the weeks.

```{r}
#| label: looking at and cleaning North Carolina survey data

# Filter for NC and remove unneeded columns
ncarolina <- strawb_survey %>% 
  filter(State == "NORTH CAROLINA") %>% 
  select(-`State ANSI`)

# Run function to remove duplicate rows
ncarolina <- drop_duplicate_rows(ncarolina)

# Summarize the weekly values to a year average
ncarolina <- ncarolina %>%
  group_by(Year, State, `Data Item`) %>%
  summarize(Value = sum(Value), Period = "YEAR", .groups = "drop") %>% 
  ungroup() %>% 
  # remove the rows with period as previous year because we have them as the actual year
  filter(!str_detect(`Data Item`, "PREVIOUS YEAR,")) %>% 
  relocate(Period, .after = Year)

```

California and Florida below ran the drop duplicate rows function and then needed an extra step to remove the monthly data as we are focusing on yearly data. The monthly data was just a further breakdown of the year data that already existed.

```{r}
#| label: looking at and cleaning California survey data

# Filter for CA and remove unneeded columns
calif <- strawb_survey %>% 
  filter(State == "CALIFORNIA") %>% 
  select(-`Week Ending`, -`State ANSI`) 

# Run function to remove duplicate rows
calif <- drop_duplicate_rows(calif)

# Filter for year periods
calif <- calif %>% 
  filter(str_detect(Period, "YEAR"))

```

```{r}
#| label: looking at and cleaning Florida survey data

# Filter for FL and remove unneeded columns
florida <- strawb_survey %>% 
  filter(State == "FLORIDA") %>% 
  select(-`Week Ending`, -`State ANSI`) 

# Run function to remove duplicate rows
florida <- drop_duplicate_rows(florida)

# Filter for year periods
florida <- florida %>% 
  filter(str_detect(Period, "YEAR"))

```

Once each state is cleaned up, we can recombine the data into a single data frame and use pivot wider to better analyze the survey data.

```{r}
#| label: put state survey data back together

# Create a list containing all of them
states_list <- list(new_york, oregon, ncarolina, calif, florida, washington)

# Bind all the data frames together into a single data table
strawb_survey <- rbindlist(states_list)

# Clean up the environment
rm(states_list)

```

```{r}
#| label: Pivot wider strawb_survey

strawb_survey_wide <- strawb_survey %>%
  pivot_wider(
    id_cols = c(Year, State),     # Columns that uniquely identify each new wide row
    names_from = `Data Item`,     # Column whose values will become the new column names
    values_from = Value           # Column whose values will fill the new columns
  )


```

## Fertilizer Data for strawberries

We sourced the data from the USDA and first read in the csv file and run the drop one value columns function to remove unnecessary columns from the data.

```{r}
#| label: read in the fertilizer data

# Read in csv file from USDA
strawb_fertilizers <- read.csv("strawberry_fertilizers.csv") 

# Run the function on the strawberry data
strawb_fertilizers <- drop_one_value_col(strawb_fertilizers)
```

To make sure all the numeric data is useable in analysis, we change the class of the data to numeric rather than characters.

```{r}
#| label: Convert Value column to numeric
#| warning: false

# Convert to numeric
strawb_fertilizers <- strawb_fertilizers %>% 
  mutate(Value = as.numeric(gsub(",", "", Value)))

```

Now let's clean up the columns that will become our column headers. We need to edit the column so we know which fertilizer is being discusses and then edit the `Data Item` column for what procedure is being performed with the designated fertilizer.

```{r}
#| label: Clean up Domain.Category to Fertilizer

# Rename Fertilizer column and clean it up 
strawb_fertilizers <- strawb_fertilizers %>% 
  rename(Fertilizer = Domain.Category) %>% 
  mutate(Fertilizer = sub(".*\\((.*?)\\).*", "\\1", Fertilizer))

```

```{r}
#| label: Clean up Data.Item column

# Remove strawberries from the start of every line in Data Item
strawb_fertilizers <- strawb_fertilizers %>% 
  mutate(Data.Item = str_remove(Data.Item, ".*-")) 

```

Once the character columns are cleaner, we can then pivot wider, so each row represents a single year for the state.

```{r}
#| label: pivot fertilizer wider 

strawb_fertilizers_wide <- strawb_fertilizers %>%
  pivot_wider(
    id_cols = c(Year, State),  # Columns that uniquely identify each new wide row
    names_from = c(Fertilizer, Data.Item), # Columns whose values will become the new column names
    values_from = Value   # Column whose values will fill the new columns
  )

```

## Organic Strawberry Data

```{r}
#| label: read in the data & run drop 1-item columns function on data

strawb_organic <- read.csv("strawb_organic.csv")
strawb_organic <- drop_one_value_col(strawb_organic)

```

```{r}
#| label: clean up the columns and class of variables.
#| warning: false

# Remove other unnecessary columns
strawb_organic <- strawb_organic %>% 
  select(-State.ANSI) 

# Converting the Value and CV(%) columns from character into numeric structure.
strawb_organic <- strawb_organic %>% 
  mutate(Value = as.numeric(gsub(",", "", strawb_organic$Value))) %>% 
  mutate(`CV....` = as.numeric(CV....))

```

```{r}
#| label: Clean-up data item column

# Remove strawberries/organic from the start of every line in Data Item
strawb_organic$Data.Item <- str_replace(
  string = strawb_organic$Data.Item,
  pattern = "^(?:STRAWBERRIES, ORGANIC - |STRAWBERRIES, ORGANIC, )",
  replacement = ""
)
```

```{r}
#| label: pivot organic wider 

strawb_organic_wide <- strawb_organic %>%
  pivot_wider(
    id_cols = c(Year, State),        # Columns that uniquely identify each new wide row
    names_from = Data.Item,          # Columns whose values will become the new column names
    values_from = c(Value, CV....)   # Column whose values will fill the new columns
  )

```




# Exploratory Data Analysis

Overview of Fertilizer Types

```{r}
fert_clean %>%count(fertilizer, sort = TRUE)
```

Nitrogen and Potash appear as the most frequently reported fertilizers, suggesting they are the core components of conventional strawberry farming.

**Geographic Patterns**

```{r}
fert_state <- fert_clean %>% 
  group_by(state, fertilizer) %>% 
  summarise(mean_value = mean(value, na.rm = T), .groups = "drop")

ggplot(fert_state, aes(x = reorder(state, mean_value), y = mean_value, fill = fertilizer)) +
  geom_bar(stat = "identity", position = "dodge") +
  coord_flip() +
  labs(
    title = "Average Fertilizer Use by State",
    x = "State",
    y = "Average Use"
  ) +
  theme_minimal()
  
```

California lead in fertilizer use reflecting their large strawberry industries.

```{r}
fert_clean %>%
  group_by(year, fertilizer) %>%
  summarise(mean_value = mean(value, na.rm = TRUE), .groups = "drop") %>%
  ggplot(aes(x = year, y = mean_value, color = fertilizer)) +
  geom_line(size = 1.2) +
  geom_point() +
  theme_minimal() +
  labs(title = "Fertilizer Use Over Time", y = "Average Use", x = "Year")
```

Phosphate use appears stable across years, but for all fertilizers, there is a spiked trend upwards from mid to late 2010s which could mean some outliers in the data set.

The data set captures fertilizer usage primarily in conventional strawberry production system where the fertilizers are applied. In contrast, organic strawberry systems rely on nutrient source like composted manure or mineral sulfur rather than synthetic chemicals. This distinction matters because organic fertilizer release nutrients slowly and improve soil health, while conventional systems enable rapid growth but may pose environmental risks such as nitrate leaching and reduced soil biodiversity.

**Conclusion**

This exploratory analysis provides an initial understanding of fertilizer use patterns in the US strawberry production:

-   Nitrogen and Potash dominate national usage

-   Fertilizer intensity is highest in major production states

-   Some fertilizers show correlated application patterns.

This report demonstrates the potential of fertilizer-use data to inform sustainability discussion in agriculture. However, a complete understanding of pros and cons requires linking fertilizer to other variables such as yield, soil quality, and economic return. Future analyses should incorporate these dimensions, along with spatial or weather data to assess fertilizer efficiency and environmental performance more directly. Future steps are our group continue with our analysis is to include linking fertilizer inputs to yield and environmental indicators to evaluate efficiency and sustainability discussions in agriculture.

Sources to be cited:

-   Data source: U.S. Department of Agriculture (USDA). *Strawberry Chemical Use Survey Dataset, 2025.*

-   Soil Science Society of America. *Nutrient Management and Environmental Impact.*

-   UC Davis Extension. *Fertilizer Management in Berry Production.*






